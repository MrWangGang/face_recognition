# 人脸识别
# 基于MobileNet卷积神经网络的人脸识别
# 因数据集涉及到隐私,如需要请联系wanggang userbean@outlook.com
本项目以**经典轻量级卷积神经网络MobileNet**为核心架构，结合三元损失函数（Triplet Loss），构建兼顾「效率与精度」的人脸识别系统，适配移动端、嵌入式设备等资源受限场景，可应用于人脸解锁、智能门禁、身份核验等实际需求。

```
┌─────────────────────┐     ┌────────────────────────────────┐
│ 输入层              │     │ RGB 图像（示例尺寸：224×224×3） │
└────────────┬────────┘     └──────────────────┬─────────────┘
             │                                 │
┌────────────▼────────┐     ┌──────────────────▼─────────────┐
│ 初始卷积块          │     │ Conv3×3（步长=2） + BN + h-swish │
│ （特征初步提取）    │     │ 输出尺寸：112×112×16（Large/Small 一致） │
└────────────┬────────┘     └──────────────────┬─────────────┘
             │                                 │
┌────────────▼─────────────────────────────────▼─────────────┐
│ 核心特征提取层：Inverted Residual 块序列（Large/Small 差异） │
│ （基于深度可分离卷积，含 SE 注意力、h-swish/ReLU 激活）     │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 1×1 卷积压缩块                                              │
│ Conv1×1 + BN + h-swish → 统一特征通道数（Large：1280；Small：1024） │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 自适应平均池化                                              │
│ AdaptiveAvgPool2d(1,1) → 输出尺寸：1×1×C（C 为压缩后通道数）  │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 展平操作                                                    │
│ 从 (Batch, C, 1, 1) 展平为 (Batch, C)                        │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 分类器模块                                                  │
│ ┌─────────────┐  ┌──────────┐  ┌──────────┐  ┌─────────────┐ │
│ │ Linear（C→O）│→ │ h-swish  │→ │ Dropout  │→ │ Linear（O→N）│ │
│ │ （O：中间维度）│  │          │  │ （0.2）  │  │ （N：类别数）│ │
│ └─────────────┘  └──────────┘  └──────────┘  └─────────────┘ │
└───────────────────────────────┬─────────────────────────────┘
                                │
┌───────────────────────────────▼─────────────────────────────┐
│ 输出层                                                      │
│ 类别概率分布（分类任务） / 特征向量（如人脸识别任务）         │
└─────────────────────────────────────────────────────────────┘
```

## 1. 核心架构：MobileNet的轻量化优势
MobileNet作为经典的轻量级CNN架构，其核心设计「深度可分离卷积」是实现“高效特征提取”的关键：
- **架构创新**：将传统标准卷积拆分为「深度卷积（Depthwise Conv）」与「逐点卷积（Pointwise Conv）」两步：
  - 深度卷积：对每个输入通道单独卷积，聚焦通道内局部特征提取，大幅减少计算量；
  - 逐点卷积：用1×1卷积整合不同通道的特征，保留跨通道信息交互。
- **资源适配性**：相比传统CNN（如VGG16），MobileNet参数量减少70%-85%，计算量降低80%以上，无需高性能GPU即可实现实时推理，完美适配手机、嵌入式设备等低功耗场景。
- **特征提取能力**：通过多组“深度可分离卷积+ReLU激活+ BatchNorm”模块堆叠，可有效捕捉人脸的关键视觉特征（如五官轮廓、纹理细节），兼顾轻量化与特征表达能力。


## 2. 损失函数：三元损失强化特征区分度
为解决人脸识别中“相似人脸难区分、同一人脸因姿态/光照变化特征差异大”的问题，项目采用**三元损失函数（Triplet Loss）** 优化模型训练：
- **三元组构建**：每次训练输入“锚点样本（Anchor）-正样本（Positive，与锚点为同一人）-负样本（Negative，与锚点为不同人）”的三元组；
- **优化目标**：通过损失函数约束“锚点与正样本的特征距离”小于“锚点与负样本的特征距离”，且满足预设间隔（Margin），公式如下：  
  `L = max(||f(A) - f(P)||² - ||f(A) - f(N)||² + Margin, 0)`  
  （其中`f(·)`为MobileNet输出的人脸特征向量）
- **效果提升**：引导模型学习“同一人脸特征聚合、不同人脸特征分离”的特征向量，显著提升对相似人脸、复杂场景（逆光、侧脸）下人脸的识别鲁棒性。


## 3. 项目核心功能与应用
- **核心流程**：覆盖“人脸图像预处理（对齐、归一化）→ MobileNet特征提取 → 三元损失训练 → 特征匹配与识别”全链路；
- **关键能力**：
  - 人脸验证（1:1）：输入两张人脸，判断是否为同一人；
  - 人脸检索（1:N）：从人脸库中快速匹配与输入人脸一致的对象；
- **应用场景**：
  - 移动端：手机人脸解锁、APP身份验证；
  - 物联网设备：智能门锁、考勤机的人脸核验；
  - 公共场景：车站/机场的快速身份比对（轻量化部署适配终端设备）。
